2025-08-26 08:47:50,658 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-26 08:47:50,659 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-26 08:47:54,741 - ERROR -  Error en autenticación
2025-08-26 08:49:02,861 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-26 08:49:02,861 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-26 08:49:06,637 - INFO -  Autenticación exitosa
2025-08-26 08:49:06,637 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-26 08:49:06,637 - ERROR - Error al descargar archivo: 'DatacampusAgent' object has no attribute 'token'
2025-08-26 08:49:06,639 - ERROR -  Error al leer Excel o Excel vacío
2025-08-26 08:53:42,276 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-26 08:53:42,276 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-26 08:53:46,070 - INFO -  Autenticación exitosa
2025-08-26 08:53:46,070 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-26 08:53:46,070 - ERROR - Error al descargar archivo: 'DatacampusAgent' object has no attribute 'token'
2025-08-26 08:53:46,070 - ERROR -  Error al leer Excel o Excel vacío
2025-08-26 08:54:56,854 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-26 08:54:56,854 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-26 08:54:56,854 - ERROR -  Error en autenticación
2025-08-26 08:55:36,893 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-26 08:55:36,893 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-26 08:55:40,629 - INFO -  Autenticación exitosa
2025-08-26 08:55:40,630 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-26 08:55:40,630 - ERROR - Error al descargar archivo: 'DatacampusAgent' object has no attribute 'token'
2025-08-26 08:55:40,630 - ERROR -  Error al leer Excel o Excel vacío
2025-08-26 09:28:03,800 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-26 09:28:03,801 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-26 09:28:07,639 - INFO -  Autenticación exitosa
2025-08-26 09:28:07,640 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-26 09:28:08,318 - ERROR - Error al descargar archivo: 401
2025-08-26 09:28:08,320 - ERROR -  Error al leer Excel o Excel vacío
2025-08-26 09:29:33,712 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-26 09:29:33,713 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-26 09:29:37,312 - INFO -  Autenticación exitosa
2025-08-26 09:29:37,312 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-26 09:29:37,991 - ERROR - Error al descargar archivo: 401
2025-08-26 09:29:37,992 - ERROR -  Error al leer Excel o Excel vacío
2025-08-26 11:42:16,763 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-26 11:42:16,764 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-26 11:42:20,692 - INFO -  Autenticación exitosa
2025-08-26 11:42:20,693 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-26 11:42:21,449 - ERROR - Error al descargar archivo: 401
2025-08-26 11:42:21,451 - ERROR -  Error al leer Excel o Excel vacío
2025-08-26 16:12:11,583 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-26 16:12:11,584 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-26 16:12:15,149 - INFO -  Autenticación exitosa
2025-08-26 16:12:15,149 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-26 16:12:15,780 - ERROR - Error al descargar archivo: 401
2025-08-26 16:12:15,781 - ERROR -  Error al leer Excel o Excel vacío
2025-08-27 11:05:06,918 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-27 11:05:06,919 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-27 11:05:10,449 - INFO -  Autenticación exitosa
2025-08-27 11:05:10,450 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-27 11:05:11,092 - ERROR - Error al descargar archivo: 401
2025-08-27 11:05:11,094 - ERROR -  Error al leer Excel o Excel vacío
2025-08-27 11:08:31,004 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-27 11:08:31,004 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-27 11:08:34,506 - INFO -  Autenticación exitosa
2025-08-27 11:08:34,506 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-27 11:08:35,135 - ERROR - Error al descargar archivo: 401
2025-08-27 11:08:35,136 - ERROR -  Error al leer Excel o Excel vacío
2025-08-27 11:22:55,610 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-27 11:22:55,611 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-27 11:22:59,505 - INFO -  Autenticación exitosa
2025-08-27 11:22:59,506 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-27 11:23:00,159 - ERROR - Error al descargar archivo: 401
2025-08-27 11:23:00,163 - ERROR -  Error al leer Excel o Excel vacío
2025-08-27 11:28:22,958 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-27 11:28:22,959 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-27 11:28:27,237 - INFO -  Autenticación exitosa
2025-08-27 11:28:27,238 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-27 11:28:27,981 - ERROR - Error al descargar archivo: 401
2025-08-27 11:28:27,986 - ERROR -  Error al leer Excel o Excel vacío
2025-08-27 11:37:09,367 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-27 11:37:09,368 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-27 11:37:13,429 - INFO -  Autenticación exitosa
2025-08-27 11:37:13,430 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-27 11:37:14,074 - ERROR - Error al descargar archivo: 401
2025-08-27 11:37:14,078 - ERROR -  Error al leer Excel o Excel vacío
2025-08-27 11:38:41,971 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-27 11:38:41,971 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-27 11:38:49,453 - INFO -  Autenticación exitosa
2025-08-27 11:38:49,454 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-27 11:38:51,619 - INFO -  Excel leído con 7 filas
2025-08-27 11:38:51,621 - ERROR -  Error al obtener Excel: unhashable type: 'dict'
2025-08-27 11:42:57,535 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-27 11:42:57,535 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-27 11:43:01,532 - INFO -  Autenticación exitosa
2025-08-27 11:43:01,533 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-27 11:43:03,342 - INFO -  Excel leído con 7 filas
2025-08-27 11:43:03,342 - INFO - 3) Filtrando registros pendientes...
2025-08-27 11:43:03,343 - ERROR -  Error al filtrar registros: list indices must be integers or slices, not str
2025-08-27 11:43:03,343 - INFO - No hay registros pendientes de certificar
2025-08-27 11:47:47,225 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-27 11:47:47,226 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-27 11:47:51,343 - INFO -  Autenticación exitosa
2025-08-27 11:47:51,344 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-27 11:47:53,261 - INFO -  Excel leído con 7 filas
2025-08-27 11:47:53,262 - INFO - 3) Filtrando registros pendientes...
2025-08-27 11:47:53,262 - ERROR -  Error al filtrar registros: 'list' object has no attribute 'get'
2025-08-27 11:47:53,262 - INFO - No hay registros pendientes de certificar
2025-08-27 11:55:18,941 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-27 11:55:18,941 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-27 11:55:22,919 - INFO -  Autenticación exitosa
2025-08-27 11:55:22,919 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-27 11:55:24,894 - INFO -  Excel leído con 7 filas
2025-08-27 11:55:24,894 - INFO - 3) Filtrando registros pendientes...
2025-08-27 11:55:24,895 - INFO -  Filtrados 3 registros pendientes
2025-08-27 11:55:24,895 - INFO - 4) Generando certificados PDF...
2025-08-27 11:55:24,896 - ERROR -  Error al generar PDFs: generar_certificados_desde_excel() takes 1 positional argument but 2 were given
2025-08-27 12:11:05,141 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-27 12:11:05,141 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-27 12:11:09,029 - INFO -  Autenticación exitosa
2025-08-27 12:11:09,030 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-27 12:11:10,913 - INFO -  Excel leído con 7 filas
2025-08-27 12:11:10,914 - INFO - 3) Filtrando registros pendientes...
2025-08-27 12:11:10,914 - INFO -  Filtrados 3 registros pendientes
2025-08-27 12:11:10,914 - INFO - 4) Generando certificados PDF...
2025-08-27 12:11:10,933 - INFO -  Generados 0 certificados PDF
2025-08-27 12:14:35,157 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-08-27 12:14:35,157 - INFO - 1) Autenticando con Microsoft Graph...
2025-08-27 12:14:39,273 - INFO -  Autenticación exitosa
2025-08-27 12:14:39,273 - INFO - 2) Descargando Excel desde OneDrive...
2025-08-27 12:14:41,212 - INFO -  Excel leído con 7 filas
2025-08-27 12:14:41,212 - INFO - 3) Filtrando registros pendientes...
2025-08-27 12:14:41,213 - INFO -  Filtrados 3 registros pendientes
2025-08-27 12:14:41,213 - INFO - 5) Subiendo certificados por empresa a OneDrive...
2025-08-27 12:14:41,213 - INFO -   Procesando empresa: Red Bull
2025-08-27 12:14:41,905 - WARNING - Error al buscar carpeta: 401
2025-08-27 12:14:42,601 - ERROR - Error al crear carpeta: 401 - {"error":{"code":"InvalidAuthenticationToken","message":"IDX14100: JWT is not well formed, there are no dots (.).\nThe token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.","innerError":{"date":"2025-08-27T17:14:42","request-id":"c1ce9062-09ae-4eba-97d6-711f35abff79","client-request-id":"c1ce9062-09ae-4eba-97d6-711f35abff79"}}}
2025-08-27 12:14:42,606 - WARNING -      No se pudo crear carpeta: Red Bull
2025-08-27 12:14:42,607 - INFO -   Procesando empresa: Mercedez
2025-08-27 12:14:43,304 - WARNING - Error al buscar carpeta: 401
2025-08-27 12:14:43,971 - ERROR - Error al crear carpeta: 401 - {"error":{"code":"InvalidAuthenticationToken","message":"IDX14100: JWT is not well formed, there are no dots (.).\nThe token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.","innerError":{"date":"2025-08-27T17:14:43","request-id":"828c4fca-8570-4f29-b470-40aebb90a8a8","client-request-id":"828c4fca-8570-4f29-b470-40aebb90a8a8"}}}
2025-08-27 12:14:43,975 - WARNING -      No se pudo crear carpeta: Mercedez
2025-08-27 12:14:43,976 - INFO -   Procesando empresa: Ferrari
2025-08-27 12:14:44,669 - WARNING - Error al buscar carpeta: 401
2025-08-27 12:14:45,362 - ERROR - Error al crear carpeta: 401 - {"error":{"code":"InvalidAuthenticationToken","message":"IDX14100: JWT is not well formed, there are no dots (.).\nThe token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.","innerError":{"date":"2025-08-27T17:14:45","request-id":"8d10ce83-33ca-423a-8bc2-08bc7f4cfb10","client-request-id":"8d10ce83-33ca-423a-8bc2-08bc7f4cfb10"}}}
2025-08-27 12:14:45,364 - WARNING -      No se pudo crear carpeta: Ferrari
2025-08-27 12:14:45,364 - INFO - 6) Actualizando Excel...
2025-08-27 12:14:45,365 - ERROR -  Error al actualizar Excel: list indices must be integers or slices, not str
2025-09-01 08:15:46,577 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-09-01 08:15:46,577 - INFO - 1) Autenticando con Microsoft Graph...
2025-09-01 08:15:51,000 - INFO -  Autenticación exitosa
2025-09-01 08:15:51,000 - INFO - 2) Descargando Excel desde OneDrive...
2025-09-01 08:15:52,872 - INFO -  Excel leído con 7 filas
2025-09-01 08:15:52,872 - INFO - 3) Filtrando registros pendientes...
2025-09-01 08:15:52,872 - INFO -  Filtrados 3 registros pendientes
2025-09-01 08:15:52,872 - INFO - 5) Subiendo certificados por empresa a OneDrive...
2025-09-01 08:15:52,873 - INFO -   Procesando empresa: Red Bull
2025-09-01 08:15:53,505 - WARNING - Error al buscar carpeta: 401
2025-09-01 08:15:54,150 - ERROR - Error al crear carpeta: 401 - {"error":{"code":"InvalidAuthenticationToken","message":"IDX14100: JWT is not well formed, there are no dots (.).\nThe token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.","innerError":{"date":"2025-09-01T13:15:53","request-id":"837e03ce-2ade-45aa-8a83-e1132875ad07","client-request-id":"837e03ce-2ade-45aa-8a83-e1132875ad07"}}}
2025-09-01 08:15:54,154 - WARNING -      No se pudo crear carpeta: Red Bull
2025-09-01 08:15:54,155 - INFO -   Procesando empresa: Mercedez
2025-09-01 08:15:54,821 - WARNING - Error al buscar carpeta: 401
2025-09-01 08:15:55,541 - ERROR - Error al crear carpeta: 401 - {"error":{"code":"InvalidAuthenticationToken","message":"IDX14100: JWT is not well formed, there are no dots (.).\nThe token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.","innerError":{"date":"2025-09-01T13:15:55","request-id":"214ca4c4-3692-4e28-825c-4be05e3b26e0","client-request-id":"214ca4c4-3692-4e28-825c-4be05e3b26e0"}}}
2025-09-01 08:15:55,546 - WARNING -      No se pudo crear carpeta: Mercedez
2025-09-01 08:15:55,546 - INFO -   Procesando empresa: Ferrari
2025-09-01 08:15:56,187 - WARNING - Error al buscar carpeta: 401
2025-09-01 08:15:56,826 - ERROR - Error al crear carpeta: 401 - {"error":{"code":"InvalidAuthenticationToken","message":"IDX14100: JWT is not well formed, there are no dots (.).\nThe token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.","innerError":{"date":"2025-09-01T13:15:56","request-id":"870fa436-f8ba-4280-8d29-dc7f2cfb6548","client-request-id":"870fa436-f8ba-4280-8d29-dc7f2cfb6548"}}}
2025-09-01 08:15:56,830 - WARNING -      No se pudo crear carpeta: Ferrari
2025-09-01 08:15:56,831 - INFO - 6) Actualizando Excel...
2025-09-01 08:15:56,832 - ERROR -  Error al actualizar Excel: list indices must be integers or slices, not str
2025-09-01 10:24:18,370 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-09-01 10:24:18,370 - INFO - 1) Autenticando con Microsoft Graph...
2025-09-01 10:24:22,593 - INFO -  Autenticación exitosa
2025-09-01 10:24:22,594 - INFO - 2) Descargando Excel desde OneDrive...
2025-09-01 10:24:24,420 - INFO -  Excel leído con 7 filas
2025-09-01 10:24:24,421 - INFO - 3) Filtrando registros pendientes...
2025-09-01 10:24:24,421 - INFO -  Filtrados 3 registros pendientes
2025-09-01 10:24:24,421 - INFO - 4) Generando certificados PDF...
2025-09-01 10:24:24,423 - INFO -  Generados 0 certificados PDF
2025-09-01 10:56:43,228 - INFO - === INICIANDO FLUJO DE CERTIFICADOS ===
2025-09-01 10:56:43,228 - INFO - 1) Autenticando con Microsoft Graph...
2025-09-01 10:56:48,220 - INFO -  Autenticación exitosa
2025-09-01 10:56:48,221 - INFO - 2) Descargando Excel desde OneDrive...
2025-09-01 10:56:50,242 - INFO -  Excel leído con 7 filas
2025-09-01 10:56:50,242 - INFO - 3) Filtrando registros pendientes...
2025-09-01 10:56:50,242 - INFO -  Filtrados 3 registros pendientes
2025-09-01 10:56:50,243 - INFO - 5) Subiendo certificados por empresa a OneDrive...
2025-09-01 10:56:50,243 - INFO -   Procesando empresa: Red Bull
2025-09-01 10:56:50,907 - WARNING - Error al buscar carpeta: 401
2025-09-01 10:56:51,570 - ERROR - Error al crear carpeta: 401 - {"error":{"code":"InvalidAuthenticationToken","message":"IDX14100: JWT is not well formed, there are no dots (.).\nThe token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.","innerError":{"date":"2025-09-01T15:56:50","request-id":"4bba2f8b-f886-4649-97dc-cf74f53cb19e","client-request-id":"4bba2f8b-f886-4649-97dc-cf74f53cb19e"}}}
2025-09-01 10:56:51,576 - WARNING -      No se pudo crear carpeta: Red Bull
2025-09-01 10:56:51,577 - INFO -   Procesando empresa: Mercedez
2025-09-01 10:56:52,220 - WARNING - Error al buscar carpeta: 401
2025-09-01 10:56:52,873 - ERROR - Error al crear carpeta: 401 - {"error":{"code":"InvalidAuthenticationToken","message":"IDX14100: JWT is not well formed, there are no dots (.).\nThe token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.","innerError":{"date":"2025-09-01T15:56:52","request-id":"ea0df480-0c1c-428b-bdb9-5f44a57ae070","client-request-id":"ea0df480-0c1c-428b-bdb9-5f44a57ae070"}}}
2025-09-01 10:56:52,876 - WARNING -      No se pudo crear carpeta: Mercedez
2025-09-01 10:56:52,876 - INFO -   Procesando empresa: Ferrari
2025-09-01 10:56:53,514 - WARNING - Error al buscar carpeta: 401
2025-09-01 10:56:54,188 - ERROR - Error al crear carpeta: 401 - {"error":{"code":"InvalidAuthenticationToken","message":"IDX14100: JWT is not well formed, there are no dots (.).\nThe token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.","innerError":{"date":"2025-09-01T15:56:53","request-id":"a22c6fe7-6991-41df-aa3b-1f1476af8189","client-request-id":"a22c6fe7-6991-41df-aa3b-1f1476af8189"}}}
2025-09-01 10:56:54,191 - WARNING -      No se pudo crear carpeta: Ferrari
2025-09-01 10:56:54,192 - INFO - 6) Actualizando Excel...
2025-09-01 10:56:54,193 - ERROR -  Error al actualizar Excel: list indices must be integers or slices, not str
